# 2024.04.06

- [x] ì˜¤ëŠ˜ í•˜ë£¨ ê³µë¶€ í–ˆë˜ ê²ƒì— ëŒ€í•´ `ì •ë¦¬í•˜ê¸°`
- [x] ì¤‘ìš”í•œ ê²ƒì„ `ìŠì§€ì•Šê¸°`

# ğŸš© Today I Learned

---

## ğŸ“š ì •ë¦¬í•˜ê¸°

- ìŠ¤í”„ë§ ì‹œíë¦¬í‹° ì¸ ì•¡ì…˜ ìš”ì•½ ì •ë¦¬ ë° ì˜ˆì œ ì½”ë“œ ì‹¤ìŠµ

---

## ğŸ· ìŠì§€ì•Šê¸°

- `DelegatingPasswordEncoder` ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, ì•”í˜¸í™”ëœ ë¹„ë°€ë²ˆí˜¸ì— í•´ë‹¹ ë¹ˆì„ ì´ˆê¸°í™”í•  ë•Œ map ì— ì„¤ì •í•œ `PasswordEncoder` ë³„ key ê°’ì„ ë„£ì–´ì¤˜ì•¼ í•œë‹¤
  ```kotlin
  // DelegatingPasswordEncoder ì„¤ì •
  @Bean
  fun delegatingPasswordEncoder(): PasswordEncoder {
      val encoders: Map<String, PasswordEncoder> =
          mapOf(
              "noop" to noOpsPasswordEncoder(),
              "bcrypt" to bcryptPasswordEncoder(),
              "scrypt" to scryptPasswordEncoder()
          )

      return DelegatingPasswordEncoder("bcrypt", encoders)
  }

  // ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™” í›„ DB ì— ì €ì¥í•˜ëŠ” ë¡œì§ ì¼ë¶€
  userRepository.save(
      User(
          id = 1,
          username = USERNAME,
          // ì´ë ‡ê²Œ {} ë¡œ ê°ì‹¸ì•¼ DelegatingPasswordEncoder.match() ì—ì„œ
          // ì¸ì½”ë”ë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤
          password = "{bcrypt}${bcryptPasswordEncoder.encode(PASSWORD)}",
          enabled = true
      )
  )
  ```
- `SecurityContext` ëŠ” `AuthenticationProvider` ê°€ ì¸ì¦í•œ ì—”í‹°í‹°ë¥¼ ì €ì¥í•˜ëŠ” ê°ì²´ì´ê³ , ì´ ì—”í‹°í‹°ëŠ” ê¸°ë³¸ì ìœ¼ë¡œëŠ” `ThreadLocal` ì— ì €ì¥ ë˜ì–´ ë™ì¼í•œ ìŠ¤ë ˆë“œ ë‹¨ìœ„ì—ì„œ ê³µìœ ë˜ëŠ” ìì›ì´ë‹¤
  - `InitializingBean` ì„ ì¬ì •ì˜í•˜ì—¬ `SecurityContext` ì˜ ì—”í‹°í‹° ë³´ê´€ ì „ëµì„ ë°”ê¾¼ë‹¤ë©´ `ExecutorService` ë‚˜ `Runnable`, `Callable` ë“±ë“± ì›¬ë§Œí•œ ë¹„ë™ê¸° í™˜ê²½ì—ì„œë„ ì¸ì¦ ì—”í‹°í‹°ë¥¼ ì „íŒŒ ë°›ì•„ ì–¸ì œë“  êº¼ë‚´ ì“¸ ìˆ˜ ìˆë‹¤
