# 2022.07.02

- [x]  오늘 하루 공부했던 것에 대해 `정리하기`
- [x]  중요한 것을 `잊지않기`

# 🚩 Today I Learned

---

## 📚 정리하기

- 데브원영님 Apache kafka 기본개념 및 생태계 영상 시청
    - [https://www.youtube.com/watch?v=catN_YhV6To](https://www.youtube.com/watch?v=catN_YhV6To)

---

## 🏷 잊지않기

- Kafka 의 메세지는 일정한 기간동안 파일 형태로 저장된다
    - 컨슈머가 메세지를 유실한 경우 다시 받아올 수 있다
- 컨슈머가 메세지를 가져간 메세지의 순서 번호(오프셋)도 저장한다
    - 파티션의 메세지 처리 순서는 보장된다
- 메세지는 여러 컨슈머에게 제공할 수 있다
- Kafka 브로커란
    - 실행된 카프카 애플리케이션 서버 중 1대
    - 3대 이상의 브로커로 클러스터 구성
    - n 대의 브로커 중 한 대는 컨트롤러 기능을 수행
        - 각 브로커에게 담당 파티션 할당 수행
        - 브로커 정상 동작 모니터링 관리
        - 주키퍼에 어떤 브로커가 컨트롤러인지를 저장함
- 토픽은 데이터의 분리 단위
    - 데이터베이스 테이블과 비슷
- 카프카는 내부의 데이터를 바이트 형태로 저장하기 때문에 게시하려는 레코드가 커스텀한 오브젝트라면 직렬화를 제공해야함
    - 레코드는 저장될 때 key value 형식으로 저장됨
    - 레코드에 오프셋이 지정된다
- 컨슈머와 토픽의 파티션은 일대일로 매치된다
- 파티션은 무조건 컨슈머 수보다 같거나 많아야함
    - 컨슈머가 더 많을 경우 파티션을 할당받지 못해 대기해야함
- 컨슈머 중 하나에 장애가 난 경우
    - 리밸런스를 토오해 파티션 컨슈머 할당을 재조정함
- 컨슈머 그룹은 분리 가능하다
    - 그룹간 장애도 격리된다!
    - 컨슈머 그룹이 여러 개라도 같은 토픽에 접근 가능
- 레플리케이션은 파티션을 복제하는 것
- 리더 파티션이란 카프카 클라이언트와 데이터를 주고받음
- 팔로워 파티션은 리더 파티션으로부터 레코드를 복제함