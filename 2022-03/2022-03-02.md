# 2022.03.02

- [x]  오늘 하루 공부했던 것에 대해 `정리하기`
- [x]  중요한 것을 `잊지않기`

# 🚩 Today I Learned

---

## 📚 정리하기

- 이펙티브 자바 요약 정리

---

## 🏷 잊지않기

- Spring 에서 전역적으로 HTTP Request 의 정보를 가져올 때 사용하는 클래스인 `RequestContextHolder` 는 static 하게 생성되며, 서블렛이 생성될 때 같이 생성됨
    - static 한 ThreadLocal 에 값을 읽고 쓰는 방식이기 때문에 같은 스레드에서 같은 값을 사용할 수 있음
    - 서블렛 단위로 생성 되기 때문에 비지니스 요청을 처리하는 곳에서 언제든 쓸 수 있게 되는 것
    - 해당 클래스는 서블렛이 관리해준다고함
- clone 재정의는 주의해서 진행해라
    - 이를 재정의해서 사용하기 보다는 복제할 대상의 필드를 참조로 하는 생성자를 만들어 팩토리로 사용하는 것을 권장한다고함
- Comparable 을 구현할지 고려하라
    - 자바 플랫폼의 거의 모든 라이브러리가 해당 인터페이스를 구현해두었다
    - compareTo 를 사용할 때에는 래퍼 클래스들의 compare 를 사용하고, 비교 연산자를 사용하지 말자
- 클래스와 멤버의 접근 권한을 최소화하라
    - 잘 설계된 컴포넌트는 내부 데이터와 내부 구현 정보를 외부에게 잘 숨긴 형태이다
    - 캡슐화를 통해 정보를 은닉하는 것은 소프트웨어 설계의 근간이 되는 원리이다
    - 섣부르게 public 으로 API 를 만들게 되면 영원히 하위 호환을 해주어야 할 지도 모른다
    - 외부에서 사용할 수 있는 API 들이 있는 톱 레벨 클래스에서는 되도록 protected 를 지양하도록 하자
        - 같은 패키지 내에서 접근이 가능해져버리기 때문에 접근할 수 있는 대상의 범위가 넓어지게되고, 또 다시 영원히 하위 호환을 해주어야 할 지도 모른다
- public 클래스에서는 public 필드가 아닌 접근자 메서드를 사용하라
- 변경 가능성을 최소화하라
    - 클래스는 되도록 불변 클래스로 만들어야함
    - 불변 클래스로 만들 수 없게 되는 경우가 생기면, 외부에서 접근할 수 있는 경로를 최소화 해야함
    - 불변 클래스는 불변이기 때문에 스레드 안전성이 보장되므로 공유해서 사용할 수 있게됨
    - 불변 클래스의 단점으로는, 값이 단 하나라도 다르다면 별개의 객체나 인스턴스로 생성해야함
- 상속보다는 컴포지션을 사용하라
    - A is-a B 관계가 아닌 이상 상속을 사용하지 말 것
    - 해당 관계가 성립되지 않는다면 상속하고싶은 클래스를 상속 받아야할 클래스의 private 필드로 선언하여 사용
    - 이를 데코레이터 패턴이라고도 함
- 상속을 고려해 설계하고 문서화하라. 그러지 않았다면 상속을 금지하라
    - 메서드가 재정의 가능할 때 해당 메서드를 재정의 했을 때 어떤 일이 일어나는지 상세하게 문서화 해야 상속-재정의로 일어나는 불상사를 막을 수 있음
        - 또 쉽게 생각하면 상속-재정의로 일어나는 문제를 막을 수 있는 근본적인 방법이 없다는 뜻인것 같기도 하다
    - 재정의 가능한 메서드란 public 혹은 protected 에서 final 이 아닌 모든 메서드를 뜻하므로, 상속에 제한을 거는 것을 습관화하자